### SQL Parts

- DML (Data Manipulation Language) : query info from database ex. insert,delete,modify
- DDL (Data Definition Language) : commands for specifying integrity constraint
  - transaction control 
  - view definition
- Embedded SQL and dynamic SQL
- Authorization

### Data definition Language

- schema for each relation
- type of values associated with each attribute
- Integrity constraints
- set of indices(index) to be maintained for each relation
- Security & Authorization 
- **physical storage** structure of each relation on disk


### Data Types in SQL

- char(n) : Fixed length character string with length n
- varchar(n) : Variable length character strings with maximun length n
- int : integer 
- smallint : small integer
- numeric(p,d) : Fixed point number. p digits with d digits right after decimal point 
ex. numeric(3,1) : 44.5 , 12.4, 69.2
- real, double precision : Floating point and double-precision floating point numbers 
- float(n) : Floating point number, with at least n digits


### Create Table

- Ai : name of attribute
- Di : data type of values in the domain of attribute Ai

```
create table r 
(A1 D1, A2 D2, ..., An Dn,
(integrity-constraint 1),
...,
(integrity-constraint k))

```

```
CREATE TABLE  Results (
	race VARCHAR(30),
	driver VARCHAR(20),
	race_rank VARCHAR(15),
	primary key(race,driver),
	foreign key (driver) references Drivers(name),
	foreign key (race) references Races(name)
);

```

### Integrity Constraints in Create Table

- types of Integrity Constraints
  - primary key (A1,...An)
  - foreign key (Am,...An) refernces r 
  - not null


###  Updates to tables

- INSERT INTO í…Œì´ë¸”ëª… VALUES (V1,V2...Vk)

```
INSERT INTO Constructors VALUES 
("McLaren" ,"British", "Mercedes", 884, 95 ,180),
("Toro Rosso", "Italian", "Ferrari", 268, 93, 180),
("Jaguar", "British", "Cosworth", 85, 93, 178);
``` 

- DELETE FROM í…Œì´ë¸”ëª…
- DROP TABLE í…Œì´ë¸”ëª…
- ALTER TABLE í…Œì´ë¸”ëª… ADD A D : í•´ë‹¹ í…Œì´ë¸”ì— Dë¼ëŠ” ë„ë©”ì¸ì„ ì§€ë‹Œ ì†ì„± Aë¥¼ ì¶”ê°€
- ALTER TABLE í…Œì´ë¸”ëª… DROP A : ì†ì„± A ì œê±°


### Select Clause

```
select A1, A2, ..., An  // Ai represents an attribute
from r1, r2, ..., rm //ri represents a relation
where P //  P is a predicate

```

â€¢ SQL name is **case insensitive**
â€¢ distinct -> force eliminaition of duplicates
â€¢ select all -> duplicate not be removed
â€¢ select * ->"all attributes"
â€¢ arithmetic expression ì‚¬ìš© ê°€ëŠ¥ (+,-,*,/) -> ì›ë³¸ í…Œì´ë¸”ì€ ë³€ê²½ X
â€¢ where ì ˆì—ëŠ” ë¹„êµì—°ì‚°ì(<,>,<>) ì™€ ë…¼ë¦¬ ì—°ì‚°ì (and, or) ì‚¬ìš© ê°€ëŠ¥, <> ëŠ” notì˜ ì—­í• 

 
** ì¶”ê°€ ì˜ˆì‹œ **
ğŸ“Œ Ai ìë¦¬ëŠ” literalë¡œ ëŒ€ì²´ ê°€ëŠ¥.
```
mysql> select '437' as foo;
+-----+
| foo |
+-----+
| 437 |
+-----+
```

 ğŸ“Œrename opreator `as` ë¡œ ì†ì„±ëª… ë³€ê²½ ê°€ëŠ¥. ìƒëµë„ ê°€ëŠ¥.
 
 ```
 select distinct T.name
from instructor as T, instructor as S
where T.salary > S.salary and S.dept_name = 'Comp. Sci.â€™
```

Q. Find the names of all instructors who have a higher salary than 
some instructor in 'Comp. Sci'.

```
â€¢ select distinct T.name
from instructor as T, instructor as S
where T.salary > S.salary and S.dept_name = 'Comp. Sci.â€™
```

 ğŸ“Œselect 'A' from test1 -> test1 í…Œì´ë¸”ì— ìˆëŠ” íŠœí”Œ ìˆ˜ë§Œí¼ Aê°€ listed

### From Clause 

```
select *
from R1,R2
```

- Cartesian product R1 X R2 -> ì˜ë¯¸ì—†ëŠ” tupleë“¤ë„ ëª¨ë‘ í¬í•¨í•˜ë¯€ë¡œ where ì ˆë¡œ ê±¸ëŸ¬ë‚¼ ìˆ˜ ìˆìŒ

### Self join

![20220429073128](https://user-images.githubusercontent.com/86418674/165858451-836166e6-555b-4289-be21-6795e3aff1c7.png)


```
select supervisor from emp_super;
select S.supervisor from emp_super as T,emp_super as S where T.person="Bob" and T.supervisor = S.supervisor;


```


### String Operation 

- `%` : matches any substring 
ex. var% : var ~ ì˜ ì˜ë¯¸. 
- `_` : matches any character
ex. var_ : vara, varc,vard ë“±ì´ ê°€ëŠ¥

```
select name
from instructor
where name like '%dar%';
```
Q. 100% ë¼ëŠ” ìŠ¤íŠ¸ë§ê³¼ ë§¤ì¹˜í•˜ê³  ì‹¶ë‹¤ë©´?
A. like '100 \%' escape '\' 


ê·¸ ì™¸ ë‹¤ì–‘í•œ OP
- concatenation
- upper <-> lower
- string length , extracting substring

### Ordering the display of tuples 

```
select distinct name
from instructor
order by name //name ê¸°ì¤€ ascending orderë¡œ ì •ë ¬
```

- ë‚´ë¦¼ì°¨ìˆœì€ order by name desc
- multiple attributesë„ ê°€ëŠ¥ - order by dept_name,name


### Where Clause

- `between a and b` : a<=x<=b 
- tuple comparison : where (instructor.ID, dept_name) = (teaches.ID, 'Biology');

### set Operations

- union
- intersect
- except

ğŸ“Œ all ì„ ë¶™ì´ë©´ not automatically eliminate duplicates. but retain duplicate.

//p.29

```
select course_id
from section as S
where semester = 'Fall' and year = 2017 and 
exists (select *
from section as T
where semester = 'Spring' and year= 2018 
and S.course_id = T.course_id);
```




